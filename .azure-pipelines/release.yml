trigger:
  - release

variables:
  configuration: Release
  signPool: MSEngSS-MicroBuild2019-1ES
  winImage: vs2017-win2016
  osxImage: macos-latest

jobs:
- job: windows
  displayName: Windows
  pool:
    name: $(signPool)
  steps:
  - template: templates/windows/compile.signed.yml
  - template: templates/windows/pack.yml

- job: macos-x64
  displayName: macOS x64
  pool:
    name: $(signPool)
  steps:
  - template: templates/osx/build.yml
    parameters:
      osxRuntime: osx-x64

- job: macos-arm64
  displayName: macOS arm64
  pool:
    name: $(signPool)
  steps:
  - template: templates/osx/build.yml
    parameters:
      osxRuntime: osx-arm64

- job: ubuntu1804_x86_64
  displayName: Ubuntu 18.04 LTS x86_64
  pool:
    vmImage: ubuntu-18.04
  steps:
  - template: templates/linux/compile.yml
  - template: templates/linux/pack.unsigned.yml
